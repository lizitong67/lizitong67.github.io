<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="PaperNote-基于时空特征融合的入侵检测系统模型"><meta name="keywords" content="科研,入侵检测,神经网络"><meta name="author" content="Alston"><meta name="copyright" content="Alston"><title>PaperNote-基于时空特征融合的入侵检测系统模型 | Alston's blog</title><link rel="shortcut icon" href="/1231489.png"><link rel="stylesheet" href="/css/index.css?version=1.7.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.7.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://v1.hitokoto.cn/?encode=js&amp;charset=utf-8&amp;select=.footer_custom_text" defer></script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  }
} </script><meta name="generator" content="Hexo 4.2.0"></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-简介"><span class="toc-text"> 1 简介</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-相关工作"><span class="toc-text"> 2 相关工作</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#21-入侵检测系统"><span class="toc-text"> 2.1 入侵检测系统</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#22-深度神经网络"><span class="toc-text"> 2.2 深度神经网络</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-mscnn-lstm设计"><span class="toc-text"> 3 MSCNN-LSTM设计</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#31-数据选择"><span class="toc-text"> 3.1 数据选择</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#32-数据处理"><span class="toc-text"> 3.2 数据处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#321-数据标准化standardization"><span class="toc-text"> 3.2.1 数据标准化（standardization）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#322-数据归一化normalization"><span class="toc-text"> 3.2.2 数据归一化（normalization）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#33-特征学习过程"><span class="toc-text"> 3.3 特征学习过程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#34-多尺度卷积multiscale-convolution"><span class="toc-text"> 3.4 多尺度卷积（multiscale convolution）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#35-lstm网络"><span class="toc-text"> 3.5 LSTM网络</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#351-rnn"><span class="toc-text"> 3.5.1 RNN</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#352-lstm"><span class="toc-text"> 3.5.2 LSTM</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#36-池化层"><span class="toc-text"> 3.6 池化层</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#37-模型反馈"><span class="toc-text"> 3.7 模型反馈</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-实验"><span class="toc-text"> 4 实验</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#41-实验数据"><span class="toc-text"> 4.1 实验数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#42-实验过程"><span class="toc-text"> 4.2 实验过程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#43-实验度量"><span class="toc-text"> 4.3 实验度量</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#44-实验结果"><span class="toc-text"> 4.4 实验结果</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-总结"><span class="toc-text"> 5 总结</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://pic4.zhimg.com/80/v2-1b0d0240350e3d8e0550845b6bdaad1e_hd.jpg"></div><div class="author-info__name text-center">Alston</div><div class="author-info__description text-center">计算机硕士在读</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">38</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">15</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">10</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">Links</div><a class="author-info-links__name text-center" href="https://blog.csdn.net/Sc0fie1d" target="_blank" rel="noopener">Alston's CSDN</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://s2.ax1x.com/2020/02/21/3uWnXD.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Alston's blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a><a class="site-page" href="/about">About</a></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> 搜索</span></a></span></div><div id="post-info"><div id="post-title">PaperNote-基于时空特征融合的入侵检测系统模型</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-03-05</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E7%A7%91%E7%A0%94/">科研</a><div class="post-meta-wordcount"><span>字数总计: </span><span class="word-count">3.5k</span><span class="post-meta__separator">|</span><span>阅读时长: 11 分钟</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><p>原文标题：Model of the intrusion detection system based on the integration of spatial-temporal features</p>
<p>原文作者：Jianwu Zhang, Yu Ling, Xingbing Fu, Xiongkun Yang, Gang Xiong, Rui Zhang</p>
<p>原文来源：Computers &amp; Security 2020</p>
<p>原文链接：<a href="https://www.sciencedirect.com/science/article/pii/S0167404819302214" target="_blank" rel="noopener">https://www.sciencedirect.com/science/article/pii/S0167404819302214</a></p>
<h1 id="1-简介"><a class="markdownIt-Anchor" href="#1-简介"></a> 1 简介</h1>
<p>传统的机器学习方法，如SVM、贝叶斯网络、聚类等，当数据集的规模较小、维度较低时，具有较好的分类效果。但是，在实际的网络环境中，存在大量的高维、无标签、非线性数据，这就要求我们建立新的入侵检测模型。</p>
<p>本文提出了一种模型，将多<kbd>尺度卷积神经网络</kbd>和<kbd>长短期记忆</kbd>相结合（Multiscale Convolutional Neural Network with Long Short-Term Memory，<kbd>MSCNN-LSTM</kbd>）。模型首先使用多尺度卷积神经网络（MSCNN）分析数据集的<kbd>空间特征</kbd>(spatial features)，然后使用长短期记忆（LSTM）网络处理<kbd>时间特征</kbd>（temporal features）。 最后，该模型利用<kbd>时空特征</kbd>（spatial-temporal features）进行分类。 在实验中，使用公共入侵检测数据集<kbd>UNSW-NB15</kbd>作为实验训练集和测试集。 与基于传统神经网络的模型相比，MSCNN-LSTM模型具有更好的准确性，误报率和误报率。</p>
<h1 id="2-相关工作"><a class="markdownIt-Anchor" href="#2-相关工作"></a> 2 相关工作</h1>
<h2 id="21-入侵检测系统"><a class="markdownIt-Anchor" href="#21-入侵检测系统"></a> 2.1 入侵检测系统</h2>
<p>IDS分类：</p>
<ul>
<li>基于特征的检测系统（signature-based）</li>
</ul>
<p>通过分析已知的攻击模式，提取流量特征；然后将这些特征与后续检测系统提取的特征进行比较，以发现后续的攻击流量并发出警告。 基于特征的检测系统的优点是准确率高，但无法分析未知的攻击方式，如0-day漏洞攻击和APT（Advanced Persistent Threat）攻击 。</p>
<ul>
<li>基于异常的检测系统（anomaly-based）</li>
</ul>
<p>也称为基于网络行为的检测系统，主要依赖于传统的机器学习和深度学习算法。 在这种方法中，首先提取部分流量特征；然后使用有监督或无监督的学习方法，基于这些特征来构建学习框架。 基于网络行为的检测系统可以检测正常和恶意网络流量， 这种方法的好处是它可以检测未知攻击。但该方法的困难的是，设计一组代表性的特征来检测网络流量并训练模型。</p>
<h2 id="22-深度神经网络"><a class="markdownIt-Anchor" href="#22-深度神经网络"></a> 2.2 深度神经网络</h2>
<ul>
<li>卷积神经网络CNN</li>
</ul>
<p>主要用于提取数据集的空间特征</p>
<ul>
<li>递归神经网络RNN</li>
</ul>
<p>为神经网络中的每个节点添加了一个<kbd>自相关加权值</kbd>作为记忆单元，可以记忆神经网络之前的状态</p>
<ul>
<li>长短期记忆网络LSTM</li>
</ul>
<p>LSTM在RNN的结构中中添加了<kbd>忘记门</kbd>，因此LSTM网络可以有效地从长序列中提取时间特征</p>
<p>时空特征是入侵检测系统中最常用的两个检测特征。目前的研究方法都应用CNN或RNN来构建单个模型，这显然不够全面。</p>
<p>数据流量中的“字节、数据包、数据流”和自然语言处理中的“字符、句子、段落”非常相似。因此，对网络流量的分类类似于将自然语言中的段落分为正样本和负样本。</p>
<h1 id="3-mscnn-lstm设计"><a class="markdownIt-Anchor" href="#3-mscnn-lstm设计"></a> 3 MSCNN-LSTM设计</h1>
<p><img src="https://s2.ax1x.com/2020/03/08/3xUrRg.png" alt="MSCNN—LSTM模型学习过程" /></p>
<h2 id="31-数据选择"><a class="markdownIt-Anchor" href="#31-数据选择"></a> 3.1 数据选择</h2>
<p>由于KDDCUP99和NSL-KDD年代过于久远，本文采用公开数据集<kbd>UNSW-NB15</kbd>.</p>
<h2 id="32-数据处理"><a class="markdownIt-Anchor" href="#32-数据处理"></a> 3.2 数据处理</h2>
<p>包括数据标准化和数据格式转换。原始数据中，每条数据都有49个特征和1个标签，其标签为“attack”和“normal”，为了以数据流的形式将数据输入到神经网络中，必须要将字符型属性转化为数值型。</p>
<p>数据集包括9中类型的异常行为：Fuzzers, Analysis, Backdoors, DoS, Exploits, Generic, Reconnaissance, Shellcode and Worms</p>
<p>特征可以分为以下几类：流量特征，基本特征，内容特征，时间特征，附加生成的特征、标签特征。</p>
<p>数据集的49个特征中，显然存在一部分冗余。因此使用前人所得出的特征子集，这些特征子集是通过使用遗传算法作为特征搜索策略，并使用逻辑回归作为分类器来获得的，如下表所示：</p>
<p><img src="https://s2.ax1x.com/2020/03/08/3xU6Mj.png" alt="特征子集" /></p>
<h3 id="321-数据标准化standardization"><a class="markdownIt-Anchor" href="#321-数据标准化standardization"></a> 3.2.1 数据标准化（standardization）</h3>
<p>特征‘proto’、‘state’、‘service’、‘attack_act’的值都是字符型的，我们将其转化为数字型。比如特征‘proto’，将其三个最重要的值‘tcp’、‘udp’、‘icmp’分别映射为1、2、3，其余协议映射为4.</p>
<h3 id="322-数据归一化normalization"><a class="markdownIt-Anchor" href="#322-数据归一化normalization"></a> 3.2.2 数据归一化（normalization）</h3>
<p>通过线性转换，将特征值归一化到[0, 1]区间内：</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.15999999999999992em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mfrac><mrow><mi>x</mi><mo>−</mo><msub><mi>x</mi><mi>min</mi><mo>⁡</mo></msub></mrow><mrow><msub><mi>x</mi><mi>max</mi><mo>⁡</mo></msub><mo>−</mo><msub><mi>x</mi><mi>min</mi><mo>⁡</mo></msub></mrow></mfrac><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>x</mi><mi>max</mi><mo>⁡</mo></msub><mi mathvariant="normal">≠</mi><msub><mi>x</mi><mi>min</mi><mo>⁡</mo></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>0</mn><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>x</mi><mi>max</mi><mo>⁡</mo></msub><mo>=</mo><msub><mi>x</mi><mi>min</mi><mo>⁡</mo></msub></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">f(x)=\left\{\begin{array}{ll}\frac{x-x_{\min }}{x_{\max }-x_{\min }}, &amp; x_{\max } \neq x_{\min } \\ 0, &amp; x_{\max }=x_{\min }\end{array}\right.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.4850999999999996em;vertical-align:-0.99255em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">{</span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4925499999999996em;"><span style="top:-3.6525499999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8184309999999999em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.1645428571428575em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.3075428571428573em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mop mtight">max</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3340428571428572em;"><span style="top:-2.3340428571428573em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.477042857142857em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mop mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3340428571428572em;"><span style="top:-2.3340428571428573em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.477042857142857em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mop mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.44509999999999994em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span></span></span><span style="top:-2.36745em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.99255em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4925499999999996em;"><span style="top:-3.6525499999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.151392em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.301392em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight">max</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31750199999999995em;"><span style="top:-2.317502em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.467502em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.36745em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.151392em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.301392em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight">max</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31750199999999995em;"><span style="top:-2.317502em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.467502em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.99255em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
<h2 id="33-特征学习过程"><a class="markdownIt-Anchor" href="#33-特征学习过程"></a> 3.3 特征学习过程</h2>
<p>整个数据流图像的空间特征，是CNN从单个的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>×</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">p \times q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span></span>图像中学到，如下图所示，然后MSCNN的输出结构是单个的数据流向量。</p>
<p>LSTM从多个数据流向量中学习时间特征，如下图所示，输出是代表网络数据流时空特征的、单个的数据流向量，它将根据提取出的特征被进行分类。</p>
<p><img src="https://s2.ax1x.com/2020/03/08/3xURZq.png" alt="特征学习过程" /></p>
<h2 id="34-多尺度卷积multiscale-convolution"><a class="markdownIt-Anchor" href="#34-多尺度卷积multiscale-convolution"></a> 3.4 多尺度卷积（multiscale convolution）</h2>
<p>对于网络流量的识别，不仅需要分散的局部特征（local feature），也需要将多个局部特征联合起来进行分类，因此将CNN调整为MSCNN。本文使用多个大小不同的<kbd>卷积核</kbd>来提取特征，并将它们组合以获得多组局部特征。MSCNN结构将基于<strong>三个原始的多尺度卷积层</strong>（每层有多个卷积核进行采集），<strong>三个卷积层</strong>，<strong>一个池化层</strong>和<strong>三个全连接层</strong>， 网络结构参数如下表所示：</p>
<p><img src="https://s2.ax1x.com/2020/03/08/3xUoz4.png" alt="MSCNN模型层级结构" /></p>
<p>MS卷积采用了三个不同尺度的卷积核，因为2×2、3×3的卷积是比较耗时的，所以在之前先进行1×1的卷积操作来降低特征空间的维度：</p>
<p><img src="https://s2.ax1x.com/2020/03/08/3xUbLR.png" alt="" /></p>
<ul>
<li>关于1×1卷积核</li>
</ul>
<p>如果当前层和下一层都只有一个通道，那么1×1卷积核确实没什么作用，但是如果它们分别为m层和n层的话，1×1卷积核可以起到一个跨通道聚合的作用，所以进一步可以起到降维（或者升维）的作用，起到减少（或增加）参数的目的。</p>
<p><img src="https://pic3.zhimg.com/80/v2-59429b22ac90930c502736b33db0d8e0_720w.jpg" alt="" /></p>
<h2 id="35-lstm网络"><a class="markdownIt-Anchor" href="#35-lstm网络"></a> 3.5 LSTM网络</h2>
<h3 id="351-rnn"><a class="markdownIt-Anchor" href="#351-rnn"></a> 3.5.1 RNN</h3>
<p>首先介绍一下传统的<strong>递归神经网络</strong>（<strong>Recurrent neural network</strong>: <strong>RNN</strong>）：</p>
<p><img src="https://pic4.zhimg.com/80/v2-f716c816d46792b867a6815c278f11cb_720w.jpg" alt="" /></p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span>为当前状态下数据的输入</li>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span>表示接收到的上一个节点的输入</li>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span>为当前节点状态下的输出</li>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>h</mi><mo mathvariant="normal">′</mo></msup></mrow><annotation encoding="application/x-tex">h^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>为传递到下一个节点的输出</li>
</ul>
<p>通过上图的公式可以看到，输出 <strong>h’</strong> 与 <strong>x</strong> 和 <strong>h</strong> 的值都相关。而 <strong>y</strong> 则常常使用 <strong>h’</strong> 投入到一个线性层（主要是进行维度映射）然后使用softmax进行分类得到需要的数据。这里的<strong>y</strong>如何通过 <strong>h’</strong> 计算得到往往看具体模型的使用方式。通过序列形式的输入，我们能够得到如下形式的RNN：</p>
<p><img src="https://pic2.zhimg.com/80/v2-71652d6a1eee9def631c18ea5e3c7605_720w.jpg" alt="" /></p>
<h3 id="352-lstm"><a class="markdownIt-Anchor" href="#352-lstm"></a> 3.5.2 LSTM</h3>
<p>LSTM是一种特殊的RNN，主要是为了解决<strong>长序列训练过程中的梯度消失和梯度爆炸</strong>问题。简单来说，就是相比普通的RNN，LSTM能够在更长的序列中有更好的表现。</p>
<p>LSTM结构（右图）和普通RNN（左图）的主要输入输出区别如下所示：</p>
<p><img src="https://pic4.zhimg.com/80/v2-e4f9851cad426dfe4ab1c76209546827_720w.jpg" alt="" /></p>
<p>相比RNN只有一个传递状态<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>h</mi><mi>t</mi></msup></mrow><annotation encoding="application/x-tex">h^t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7935559999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span></span></span></span>，LSTM有两个传输状态，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>c</mi><mi>t</mi></msup></mrow><annotation encoding="application/x-tex">c^t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7935559999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span></span></span></span>（cell state）和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>h</mi><mi>t</mi></msup></mrow><annotation encoding="application/x-tex">h^t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7935559999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span></span></span></span>（hidden state）。其中<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>c</mi><mi>t</mi></msup></mrow><annotation encoding="application/x-tex">c^t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7935559999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span></span></span></span>改变得很慢，通常输出的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>c</mi><mi>t</mi></msup></mrow><annotation encoding="application/x-tex">c^t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7935559999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span></span></span></span>是上一个状态传过来的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>c</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">c^{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>加上一些数值。而<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>h</mi><mi>t</mi></msup></mrow><annotation encoding="application/x-tex">h^t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7935559999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span></span></span></span>则在不同节点下往往会有很大的区别.</p>
<ul>
<li>首先使用LSTM的当前输入<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mi>t</mi></msup></mrow><annotation encoding="application/x-tex">x^t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7935559999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span></span></span></span>和上一个状态传递下来的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>h</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">h^{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>拼接训练得到四个状态：</li>
</ul>
<p><img src="https://pic4.zhimg.com/80/v2-15c5eb554f843ec492579c6d87e1497b_720w.jpg" alt="" /></p>
<p>其中，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>z</mi><mi>f</mi></msup></mrow><annotation encoding="application/x-tex">z^f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span></span></span></span></span></span></span></span></span></span></span>、<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>z</mi><mi>i</mi></msup></mrow><annotation encoding="application/x-tex">z^i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.824664em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span></span></span></span>、<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>z</mi><mi>o</mi></msup></mrow><annotation encoding="application/x-tex">z^o</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.664392em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">o</span></span></span></span></span></span></span></span></span></span></span>是由拼接向量乘以权重矩阵之后，再通过一个<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><mi>o</mi><mi>i</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">sigmoid</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">i</span><span class="mord mathdefault">d</span></span></span></span>激活函数转换成0到1之间的数值，来作为一种门控状态。而<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span></span></span></span>则是将结果通过一个<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mi>a</mi><mi>n</mi><mi>h</mi></mrow><annotation encoding="application/x-tex">tanh</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord mathdefault">h</span></span></span></span>激活函数将转换成-1到1之间的值（这里使用<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mi>a</mi><mi>n</mi><mi>h</mi></mrow><annotation encoding="application/x-tex">tanh</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord mathdefault">h</span></span></span></span>是因为这里是将其做为输入数据，而不是门控信号）。</p>
<ul>
<li><strong>下面开始进一步介绍这四个状态在LSTM内部的使用</strong></li>
</ul>
<p><img src="https://pic2.zhimg.com/80/v2-556c74f0e025a47fea05dc0f76ea775d_720w.jpg" alt="" /></p>
<p>其中，<img src="https://www.zhihu.com/equation?tex=%5Codot" alt="" /> 是Hadamard Product，也就是操作矩阵中对应的元素相乘，因此要求两个相乘矩阵是同型的。 <img src="https://www.zhihu.com/equation?tex=%5Coplus" alt="" /> 则代表进行矩阵加法。</p>
<p>LSTM主要有三个阶段：</p>
<ul>
<li><kbd>忘记阶段</kbd></li>
</ul>
<p>这个阶段主要是对上一个节点传进来的输入进行<strong>选择性</strong>忘记。简单来说就是会 “忘记不重要的，记住重要的”。具体来说是通过计算得到的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>z</mi><mi>f</mi></msup></mrow><annotation encoding="application/x-tex">z^f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span></span></span></span></span></span></span></span></span></span></span>（f表示forget）来作为忘记门控，来控制上一个状态的$c^{t-1} $哪些需要留哪些需要忘。</p>
<ul>
<li><kbd>选择记忆阶段</kbd></li>
</ul>
<p>这个阶段将这个阶段的输入有选择性地进行“记忆”，会对输入<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mi>t</mi></msup></mrow><annotation encoding="application/x-tex">x^t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7935559999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span></span></span></span>进行选择记忆。哪些重要则着重记录下来，哪些不重要，则少记一些。当前的输入内容由前面计算得到的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span></span></span></span>表示。而选择的门控信号则是由<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>z</mi><mi>i</mi></msup></mrow><annotation encoding="application/x-tex">z^i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.824664em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span></span></span></span>（i代表information）来进行控制。</p>
<blockquote>
<p>将上面两步得到的结果相加，即可得到传输给下一个状态的$ c^t $，也就是上图中的第一个公式。</p>
</blockquote>
<ul>
<li><kbd>输出阶段</kbd></li>
</ul>
<p>这个阶段将决定哪些将会被当成当前状态的输出。主要是通过$z^o <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">来</mi><mi mathvariant="normal">进</mi><mi mathvariant="normal">行</mi><mi mathvariant="normal">控</mi><mi mathvariant="normal">制</mi><mi mathvariant="normal">的</mi><mi mathvariant="normal">。</mi><mi mathvariant="normal">并</mi><mi mathvariant="normal">且</mi><mi mathvariant="normal">还</mi><mi mathvariant="normal">对</mi><mi mathvariant="normal">上</mi><mi mathvariant="normal">一</mi><mi mathvariant="normal">阶</mi><mi mathvariant="normal">段</mi><mi mathvariant="normal">得</mi><mi mathvariant="normal">到</mi><mi mathvariant="normal">的</mi></mrow><annotation encoding="application/x-tex">来进行控制的。并且还对上一阶段得到的</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0em;vertical-align:0em;"></span><span class="mord cjk_fallback">来</span><span class="mord cjk_fallback">进</span><span class="mord cjk_fallback">行</span><span class="mord cjk_fallback">控</span><span class="mord cjk_fallback">制</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">。</span><span class="mord cjk_fallback">并</span><span class="mord cjk_fallback">且</span><span class="mord cjk_fallback">还</span><span class="mord cjk_fallback">对</span><span class="mord cjk_fallback">上</span><span class="mord cjk_fallback">一</span><span class="mord cjk_fallback">阶</span><span class="mord cjk_fallback">段</span><span class="mord cjk_fallback">得</span><span class="mord cjk_fallback">到</span><span class="mord cjk_fallback">的</span></span></span></span>c^t $进行了放缩（通过一个tanh激活函数进行变化）。</p>
<p>与普通RNN类似，输出$y^t <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">往</mi><mi mathvariant="normal">往</mi><mi mathvariant="normal">最</mi><mi mathvariant="normal">终</mi><mi mathvariant="normal">也</mi><mi mathvariant="normal">是</mi><mi mathvariant="normal">通</mi><mi mathvariant="normal">过</mi></mrow><annotation encoding="application/x-tex">往往最终也是通过</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0em;vertical-align:0em;"></span><span class="mord cjk_fallback">往</span><span class="mord cjk_fallback">往</span><span class="mord cjk_fallback">最</span><span class="mord cjk_fallback">终</span><span class="mord cjk_fallback">也</span><span class="mord cjk_fallback">是</span><span class="mord cjk_fallback">通</span><span class="mord cjk_fallback">过</span></span></span></span>h^t $变化得到的</p>
<h2 id="36-池化层"><a class="markdownIt-Anchor" href="#36-池化层"></a> 3.6 池化层</h2>
<p>池化的目的是减少训练参数，加快网络训练速度，其主要作用是执行<strong>下采样</strong>（down-sampling）。通过池化可以降低模型的过拟合，提高模型的泛化能力。池化包括两种：</p>
<ul>
<li><strong>最大值池化</strong>（max-pooling）：通过subsample数据，主要选择那些具有更好的分类和标识的特征，因此总的来说，其效果比较好</li>
<li><strong>均值池化</strong>（mean-pooling）</li>
</ul>
<p>但是特征提取的误差主要来自于两方面：由于邻域大小的限制，估计值的方差增大；卷积层参数的误差导致估计值的偏差。均值池化可以缓解第一种，最大值池化可以缓解第二种。</p>
<blockquote>
<p>即均值池化可以保留更多的背景特征信息，它强调整体的特征信息；而最大值池化可以保留更多的纹理特征信息，它强调局部的重点。</p>
</blockquote>
<p>因此均值池化在信息的完全传递中会更有用，而使用最大值池化会丢失许多特征信息。因此<strong>本文选用均值池化</strong>。</p>
<h2 id="37-模型反馈"><a class="markdownIt-Anchor" href="#37-模型反馈"></a> 3.7 模型反馈</h2>
<p>模型在CNN中使用反向传播算法（back propagation：BP）。</p>
<ul>
<li><strong>残差网络</strong>（<strong>Residual Network</strong>，<strong>ResNet</strong>）</li>
</ul>
<p>随着神经网络层数的加深，会产生梯度爆炸（激活值变为无穷大）和梯度消失（激活值变为无穷小）问题。残差网络通过<strong>跳跃连接</strong>，将前面的激活值跳过中间的网络层，直接传递到更后面的网络层中去，以此来避免梯度消失和梯度爆炸。从而<strong>使得训练更深层次的神经网络成为可能</strong>。</p>
<h1 id="4-实验"><a class="markdownIt-Anchor" href="#4-实验"></a> 4 实验</h1>
<h2 id="41-实验数据"><a class="markdownIt-Anchor" href="#41-实验数据"></a> 4.1 实验数据</h2>
<p>训练集中包含175341条数据，测试集中包含82332条数据。采样需要遵循<strong>大样本平均采样</strong>和<strong>小样本完整采样</strong>的原则。 通过采样获得的测试集为Test_Set_A。 下表中显示了每个数据集中的异常行为类别和分布。</p>
<p><img src="https://s2.ax1x.com/2020/03/08/3xUvFK.png" alt="" /></p>
<p>为了进一步测试模型的泛化能力，这项工作中使用了一个新的测试集Test_Set_B。 观察数据集，我们可以发现网络流量的正常行为大约占总流量的三分之一，而罕见的攻击类别“Worms”和“Shellcode”仅占很小的比例。因此，在Test_Set_B中，“Worms”和“Shellcode”类型的比例有所增加。 下表展示了测试集Test_Set_B的具体分布：</p>
<p><img src="https://s2.ax1x.com/2020/03/08/3xa9QH.png" alt="" /></p>
<h2 id="42-实验过程"><a class="markdownIt-Anchor" href="#42-实验过程"></a> 4.2 实验过程</h2>
<p>每个MS卷积层使用三种不同大小的卷积核，padding方法使用“same padding”，损失函数使用“Categorical_crossentropy function”，优化器使用“AdamOptimizer”，权重和偏移量使用0均值的高斯初始化。</p>
<p>使用dropout来避免过拟合，其连接概率p在通过实验探索后选取p=0.5</p>
<h2 id="43-实验度量"><a class="markdownIt-Anchor" href="#43-实验度量"></a> 4.3 实验度量</h2>
<p><img src="https://s2.ax1x.com/2020/03/08/3xaefS.png" alt="" /></p>
<h2 id="44-实验结果"><a class="markdownIt-Anchor" href="#44-实验结果"></a> 4.4 实验结果</h2>
<p>设置了三个对照实验：</p>
<p><img src="https://s2.ax1x.com/2020/03/08/3xaGkV.png" alt="" /></p>
<p>下图比较了在罕见攻击情况下这四个模型的检测能力。检测罕见攻击情况的重点是减少误报率</p>
<p><img src="https://s2.ax1x.com/2020/03/08/3xadX9.png" alt="" /></p>
<h1 id="5-总结"><a class="markdownIt-Anchor" href="#5-总结"></a> 5 总结</h1>
<ul>
<li>尽管使用神经网络不需要太多的关注特征工程，但是在面对众多的特征时，需要进行进一步的特征选择</li>
<li>现实中，恶意软件流量相对于正常流量来说占比很小，而且不同而已流量所占的比例也不同，因此提高模型的泛化能力是关键</li>
<li>学习点：MSCNN-LSTM集成模型</li>
</ul>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Alston</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="/alst0n.site/2020/03/05/PaperNote-%E5%9F%BA%E4%BA%8E%E6%97%B6%E7%A9%BA%E7%89%B9%E5%BE%81%E8%9E%8D%E5%90%88%E7%9A%84%E5%85%A5%E4%BE%B5%E6%A3%80%E6%B5%8B%E7%B3%BB%E7%BB%9F%E6%A8%A1%E5%9E%8B/">alst0n.site/2020/03/05/PaperNote-%E5%9F%BA%E4%BA%8E%E6%97%B6%E7%A9%BA%E7%89%B9%E5%BE%81%E8%9E%8D%E5%90%88%E7%9A%84%E5%85%A5%E4%BE%B5%E6%A3%80%E6%B5%8B%E7%B3%BB%E7%BB%9F%E6%A8%A1%E5%9E%8B/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="alst0n.site">Alston's blog</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%A7%91%E7%A0%94/">科研</a><a class="post-meta__tags" href="/tags/%E5%85%A5%E4%BE%B5%E6%A3%80%E6%B5%8B/">入侵检测</a><a class="post-meta__tags" href="/tags/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/">神经网络</a></div><nav id="pagination"><div class="next-post pull-right"><a href="/2020/02/26/PaperNote-%E4%B8%80%E7%A7%8D%E6%83%85%E6%8A%A5%E9%A9%B1%E5%8A%A8%E7%9A%84%E5%AE%89%E5%85%A8%E6%84%9F%E7%9F%A5APT%E9%98%B2%E5%BE%A1%E6%9C%BA%E5%88%B6/"><span>PaperNote-一种情报驱动的安全感知APT防御机制</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer class="footer-bg" style="background-image: url(https://s2.ax1x.com/2020/02/21/3uWnXD.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2020 By Alston</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody" target="_blank" rel="noopener"><span>Melody</span></a></div><div class="footer_custom_text">hitokoto</div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.7.0"></script><script src="/js/fancybox.js?version=1.7.0"></script><script src="/js/sidebar.js?version=1.7.0"></script><script src="/js/copy.js?version=1.7.0"></script><script src="/js/fireworks.js?version=1.7.0"></script><script src="/js/transition.js?version=1.7.0"></script><script src="/js/scroll.js?version=1.7.0"></script><script src="/js/head.js?version=1.7.0"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script src="/js/katex.js"></script><script src="/js/search/local-search.js"></script><script id="ribbon" src="/js/third-party/canvas-ribbon.js" size="150" alpha="0.6" zIndex="-1" data-click="false"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>